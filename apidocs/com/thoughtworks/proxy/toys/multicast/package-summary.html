<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_20) on Thu May 13 13:30:13 CEST 2010 -->
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>
com.thoughtworks.proxy.toys.multicast (ProxyToys Core 1.0 API)
</TITLE>

<META NAME="date" CONTENT="2010-05-13">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="com.thoughtworks.proxy.toys.multicast (ProxyToys Core 1.0 API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Package</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <FONT CLASS="NavBarFont1">Class</FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-use.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../com/thoughtworks/proxy/toys/hotswap/package-summary.html"><B>PREV PACKAGE</B></A>&nbsp;
&nbsp;<A HREF="../../../../../com/thoughtworks/proxy/toys/nullobject/package-summary.html"><B>NEXT PACKAGE</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?com/thoughtworks/proxy/toys/multicast/package-summary.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="package-summary.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<H2>
Package com.thoughtworks.proxy.toys.multicast
</H2>
A toy to perform a single call on multiple objects and manage the
    results.
<P>
<B>See:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="#package_description"><B>Description</B></A>
<P>

<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Interface Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../com/thoughtworks/proxy/toys/multicast/Multicast.html" title="interface in com.thoughtworks.proxy.toys.multicast">Multicast</A></B></TD>
<TD>Interface that is implemented by all multicasting proxies.</TD>
</TR>
</TABLE>
&nbsp;

<P>

<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Class Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../com/thoughtworks/proxy/toys/multicast/Multicasting.html" title="class in com.thoughtworks.proxy.toys.multicast">Multicasting&lt;T&gt;</A></B></TD>
<TD>Toy factory to create proxies delegating a call to multiple objects and managing the individual results.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../com/thoughtworks/proxy/toys/multicast/Multicasting.MulticastingBuild.html" title="class in com.thoughtworks.proxy.toys.multicast">Multicasting.MulticastingBuild&lt;T&gt;</A></B></TD>
<TD>&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../com/thoughtworks/proxy/toys/multicast/Multicasting.MulticastingWith.html" title="class in com.thoughtworks.proxy.toys.multicast">Multicasting.MulticastingWith&lt;T&gt;</A></B></TD>
<TD>&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../com/thoughtworks/proxy/toys/multicast/MulticastingInvoker.html" title="class in com.thoughtworks.proxy.toys.multicast">MulticastingInvoker&lt;T&gt;</A></B></TD>
<TD>A <A HREF="../../../../../com/thoughtworks/proxy/Invoker.html" title="interface in com.thoughtworks.proxy"><CODE>Invoker</CODE></A> implementation that multicasts calls to multiple targets.</TD>
</TR>
</TABLE>
&nbsp;

<P>
<A NAME="package_description"><!-- --></A><H2>
Package com.thoughtworks.proxy.toys.multicast Description
</H2>

<P>
<p>A toy to perform a single call on multiple objects and manage the
    results.</p>

<p>The package provides a proxy factory creating proxies, that can
    delegate a single call to a lot of different instances and manages the
    individual results. Main component is the <A HREF="../../../../../com/thoughtworks/proxy/toys/multicast/Multicasting.html" title="class in com.thoughtworks.proxy.toys.multicast">Multicasting toy</A>, a
    utility class creating these proxies. Such a proxy contains an instance
    of a <A HREF="../../../../../com/thoughtworks/proxy/toys/multicast/MulticastingInvoker.html" title="class in com.thoughtworks.proxy.toys.multicast"><CODE>MulticastingInvoker</CODE></A>
    that delegates the calls.</p>

<p>The multicasting toy will always try to optimize the created proxy
    taking the types into regard, that is should implement, the types of all
    delegated objects and all their interfaces:</p>
<ul>
    <li>avoid a proxy at all, if the call is delegated to only one object
        and this object implements all necessary types
    </li>
    <li>if only target object are given but no types, create a proxy that
        implements any interface of all target instances and also the most
        common super class (if the ProxyFactory supports this)
    </li>
</ul>
<p>The multicasting proxy has some surprising features. What will be the
    result of a call? The problem is, that a method will just return a
    specific type, but not necessarily an array or collection of them. What
    to do about primitives? The MulticatingInvoker implements a simple
    strategy:</p>
<ol>
    <li>if the return value of the called methods is an object, drop all
        null returned values and create for the remaining objects a new
        Multicasting proxy (rules above apply) or return <code>null</code> if
        none is left
    </li>
    <li>if the return value is a primitive (except a <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Boolean.html?is-external=true" title="class or interface in java.lang"><CODE>Boolean</CODE></A>), then sum up the values and return the sum
    </li>
    <li>if the return value is a <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Boolean.html?is-external=true" title="class or interface in java.lang"><CODE>Boolean</CODE></A>, then return <code>true</code>
        if any method call returned also <code>true</code> otherwise return <code>false</code></li>
</ol>
<p>Note that the multicasting invoker does not handle exceptions. If one
    method call throws, the exception is not catched.</p>

<p>Following example demonstrates a multicast to two different list
    objects. First of all implements the proxy the type <A HREF="http://java.sun.com/j2se/1.5.0/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util"><CODE>List</CODE></A> automatically. The method <code>add</code> returns a <code>boolean</code>,
    which will be logically and-combined for the overall result of the call.
    The content of the two lists will be printed only if the element was
    added to both lists:</p>

<div class="Source Java"><pre>ArrayList&lt;String&gt; arrayList = new ArrayList&lt;String&gt;();
LinkedList&lt;String&gt; linkedList = new LinkedList&lt;String&gt;();
&#64;SuppressWarnings("unchecked")
List&lt;String&gt; listCombined = List.class.cast(Multicasting.proxy(arrayList, linkedList).build());
if (listCombined.add("Hello")) {
    System.out.println("List 1: " + arrayList.toString());
    System.out.println("List 2: " + linkedList.toString());
}
</pre>
</div>
<p>Next example demonstrates the multicast of a method on a proxy, that
    cannot implement the necessary type for the method, because
    Integer.class is final for which it should create the proxy.
    Nevertheless the call to <code>intValue</code> succeeds and the
    resulting values are summed up. And do not get confused by the value,
    the result is <strong>8</strong>:</p>

<div class="Source Java"><pre>List&lt;Integer&gt; list1 = new ArrayList&lt;Integer&gt;();
list1.add(5);
list1.add(100);
List&lt;Integer&gt; list2 = new LinkedList&lt;Integer&gt;();
list2.add(3);
&#64;SuppressWarnings("unchecked")
List&lt;Integer&gt; listCombined = List.class.cast(Multicasting.proxy(list1, list2).build());
Multicast values = Multicast.class.cast(listCombined.get(0));
System.out.println("Sum of the first integers: " + values.multicastTargets(Integer.class, "intValue", null).toString());
</pre>
</div>
<p>In this use case we demonstrate, that the proxy can implement
    different types and a multicast will only be executed on the valid
    targets:</p>

<div class="Source Java"><pre>File workingDir = new File(".");
List&lt;String&gt; files = Arrays.asList(workingDir.list());
File multicast = Multicasting.proxy(File.class, List.class)
    .with(workingDir, files)
    .build(new CglibProxyFactory());
System.out.println("Current working directory: " + multicast.getAbsolutePath());
System.out.println("Files in working directory: " + List.class.cast(multicast).size());
</pre>
</div>
<p>If the result of a method is a final class, there is normally no way
    to access the resulting elements, since the proxy cannot implement the
    class type. In this example we access the String targets with the help
    of the <A HREF="../../../../../com/thoughtworks/proxy/toys/multicast/Multicast.html" title="interface in com.thoughtworks.proxy.toys.multicast">Multicast interface</A>:</p>

<div class="Source Java"><pre>Method method = String.class.getMethod("length");
Multicast multicast = Multicasting.proxy("ProxyToys", "is", "great").build();
System.out.println("Total number of characters: " + multicast.multicastTargets(method, null));
String[] strings = multicast.getTargetsInArray(String.class);
for (int i = 0; i < strings.length; i++) {
    System.out.println("String[" + i + "]: " + strings[i]);
}
</pre>
</div>
<p>The last example demonstrates the inheritance of the multicast proxy,
    the filtering of <code>null</code> values in the result and the
    abandonment of the proxy if it is no longer necessary. Here we get with
    the call of the <code>iterator</code> method again a multicasting proxy.
    The call of the <code>next</code> method will result in a <code>null</code>
    value from the set and the String from the list. Since the String class
    is final, the returned value from the call is no longer a proxy, the
    cast would fail:</p>

<div class="Source Java"><pre>List&lt;String&gt; list = new ArrayList&lt;String&gt;();
Set&lt;String&gt; set = new HashSet&lt;String&gt;();
list.add("ProxyToys");
set.add(null);
&#64;SuppressWarnings("unchecked")
Collection&lt;String&gt; collection = Collection.class.cast(Multicasting.proxy(list, set).build());
Iterator&lt;String&gt; iter = collection.iterator();
String value = iter.next();
System.out.println("Element gained from the iterator: " + value);
</pre>
</div>
<P>

<P>
<DL>
</DL>
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Package</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <FONT CLASS="NavBarFont1">Class</FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-use.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../com/thoughtworks/proxy/toys/hotswap/package-summary.html"><B>PREV PACKAGE</B></A>&nbsp;
&nbsp;<A HREF="../../../../../com/thoughtworks/proxy/toys/nullobject/package-summary.html"><B>NEXT PACKAGE</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?com/thoughtworks/proxy/toys/multicast/package-summary.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="package-summary.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &#169; 2005-2010 <a href="http://codehaus.org/">Codehaus</a>. All Rights Reserved.
</BODY>
</HTML>
